<html>
  <head>
    <title>typewriter: just write</title>

    <style>
html, body {
  padding: 0;
  margin: 0;
  background-color: black;
  display: flex;
  justify-content: flex-start;

}
textarea {
  cursor: none;
  position: fixed;
  border: none;
  max-width: 1300px;
  height: 100%;
  background: black;
  color: white;
  font-family: courier;
  font-size: 2.0em;
  min-width: 800px;
  width: 100%;
  padding-top: 60px;
  padding-left: 60px;
  overflow: scroll;
  resize: none;
}

textarea:focus {
  border: 0px;
  outline: none;
}
    </style>
  </head>
  <body>
    <textarea id="write"></textarea>
  </body>

  <script>
    let hasPressedAnyKey = false;
    let hasJustPressedHelp = false;
    let showHelp = true

    let textarea = document.getElementById("write");
    let cachedText = ""

    let prompts = [
      'just write',
      'describe your take\non existence',
      'what cloud formation best represents\nyour current\ntemperament',
      'what would you do if you had one year to live?',
      'write some details about the day\nthe more random and meaningless the better'
    ]

    let prompt = prompts[Math.floor(Math.random()*prompts.length)]

    textarea.value = prompt + "\n\n"

    textarea.focus()

    textarea.addEventListener("keydown", function(event) {
      console.log(event.key)
      let keyGetHelp = (event.key === "?")
      let keyLog = (event.key === "l" && event.altKey)
      let keyToggleOff = (event.key === "s" && event.ctrlKey)

      if (hasJustPressedHelp) {
        hasJustPressedHelp = false

        return textarea.value = cachedText;
      }

      if (keyToggleOff) {
        if (showHelp) {
          showHelp = false
        } else {
          showHelp = true
        }
      }

      if (keyGetHelp && showHelp) {
        // show help
        hasJustPressedHelp = true
        cachedText = textarea.value + "?";
        let result = cachedText;

        result += "\n\n"
        // result += "hit cmd-s to save\n"
        result += "to turn this off ctrl-s\n\n"
        result += "cmd-l to log this entry\n"
        result += "cmd-b for bird sounds\n"
        result += "cmd-p for a prompt\n\n"
        result += "or just keep typing..."

        textarea.value = result;

        return event.preventDefault()
      }

      if (keyLog) {
        let result = textarea.value;

        result += "\n\n"
        result += "first word:\n"
        result += "last word:\n"
        result += "password:\n\n"
        result += "anyone with these credentials will be able to view your log "
        + "which will be saved forever on the blockchain.\n"


        return textarea.value = result;
      }

      if (hasPressedAnyKey === false) {
        // clear the junk
        hasPressedAnyKey = true;

        const el = document.documentElement,
            rfs = el.requestFullScreen
                  || el.webkitRequestFullScreen
                  || el.mozRequestFullScreen;

        rfs.call(el);

        textarea.value = "";
      }
    });
  </script>
</html>
